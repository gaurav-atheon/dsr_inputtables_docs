version: 2

sources:
    - name: dsr_input
      description: Standard input tables for all inbound DSR data.
      database: AA_DSR_RAW
      tables:
        - name: input_date
          description: Raw date data.
          tests:
            - dbt_utils.unique_combination_of_columns:
                combination_of_columns:
                  - day_date
          columns:
             - name: day_date
               description: Number assigned to the organisation by the origin organisation.
               tests:
                  - not_null

        - name: input_calendar
          description: Raw date data from origin organisations.
          tests:
            - dbt_utils.unique_combination_of_columns:
                combination_of_columns:
                  - business_organisation_number
                  - origin_organisation_number
                  - day_date
                  - loaded_timestamp
          columns:
            - name: business_organisation_number
              description: Nummber assigned to the organisation by the origin.
              tests:
                - not_null
            - name: origin_organisation_number
              description: Number assigned to the organisation by the origin organisation.
              tests:
                - not_null
            - name: day_date
              description: Number assigned to the organisation by the origin organisation.
              tests:
                - not_null